{
    "name": "Cabinet",
    "schema-version": "0.5",
    "tool-version": "1.5",
    "author": "DCAN Lab, University of Minnesota",
    "url": "https://github.com/DCAN-Labs/CABINET",
    "command-line": "/home/cabinet/run.py [SUBJECT_DIR] [CABINET_OUTPUT_DIR] participant -end postbibsnet -jargs /home/cabinet/parameter-file-container.json [PARTICIPANT_LABEL] [AGE_MONTHS] [BRAIN_Z_SIZE] [SES_LABEL] [VERBOSE]",
    "description": "An automated segmentation pipeline for generating freesurfer style aseg volumes on infant/neonatal T1 and T2 weighted MRIs.",
    "inputs": [
        {
            "description": "The study-wide BIDS directory. In CBRAIN this is also referred to (and used) as the subject directory since a new BIDS dir will be made for the selected subject prior to processing.",
            "id": "subject_dir",
            "name": "subject_dir",
            "optional": false,
            "type": "File",
            "value-key": "[SUBJECT_DIR]"
        },
        {
            "description": "The CABINET output directory where all child-pipeline derivatives folders will be stored.",
            "id": "CABINET_OUTPUT_DIR",
            "name": "CABINET_OUTPUT_DIR",
            "optional": false,
            "type": "File",
            "value-key": "[CABINET_OUTPUT_DIR]"
        },
        {
           "command-line-flag": "-participant",
            "description": "Subject ID without the sub- prefix (i.e. for sub-01 should be 01)",
            "id": "sub_id",
            "name": "sub_id",
            "optional": true,
            "type": "String",
            "value-key": "[PARTICIPANT_LABEL]"
        },
        {
           "command-line-flag": "-age",
            "description": "Integer representing participant's age in months. Include this unless age in months is specified in participants.tsv file.",
            "id": "age_months",
            "name": "age months",
            "optional": true,
            "type": "String",
            "value-key": "[AGE_MONTHS]"
        },
        {
           "command-line-flag": "--brain-z-size",
            "description": "Include this flag to infer participants' brain height (z) using the participants.tsv brain_z_size column. Otherwise, CABINET will estimate the brain height from the participant age and averages of a large sample of infant brain heights.",
            "id": "brain_z_size",
            "name": "brain z size",
            "optional": true,
            "type": "Flag",
            "value-key": "[BRAIN_Z_SIZE]"
        },
        {
           "command-line-flag": "-ses",
            "description": "Session label without ses-* prefix.",
            "id": "session_label",
            "name": "session label",
            "optional": true,
            "type": "String",
            "value-key": "[SES_LABEL]"
        },
        {
           "command-line-flag": "--verbose",
            "description": "Print out extra details during processing.",
            "id": "verbose",
            "name": "verbose",
            "optional": true,
            "type": "Flag",
            "value-key": "[VERBOSE]"
        }
      ],
    "output-files" : [{
        "id" : "prebibsnet_output_dir",
        "name" : "Prebibsnet Output Directory",
        "description" : "Subject output folder for prebibsnet",
        "path-template" : "[CABINET_OUTPUT_DIR]/prebibsnet/[SUBJECT_DIR]",
        "optional" : false
    },
    {
        "id" : "bibsnet_output_dir",
        "name" : "BIBSNET Output Directory",
        "description" : "Subject output folder for bibsnet",
        "path-template" : "[CABINET_OUTPUT_DIR]/bibsnet/[SUBJECT_DIR]",
        "optional" : false
    },
    {
        "id" : "postbibsnet_output_dir",
        "name" : "Postbibsnet Output Directory",
        "description" : "Subject output folder for postbibsnet",
        "path-template" : "[CABINET_OUTPUT_DIR]/postbibsnet/[SUBJECT_DIR]",
        "optional" : false
    },
    {
        "id" : "precomputed_output_dir",
        "name" : "Precomputed Output Directory",
        "description" : "Subject output folder for precomputed",
        "path-template" : "[CABINET_OUTPUT_DIR]/precomputed/[SUBJECT_DIR]",
        "optional" : false
    }],
    "suggested-resources": {
        "cpu-cores":4,
        "ram": 30,
        "walltime-estimate": 15000
    },
    "tags": {
        "application-type": [
            "bids"
        ],
        "domain": [
            "neuroinformatics",
            "eeg",
            "developmental"
        ]
    },
    "container-image": {
        "type": "singularity",
        "index": "docker://",
        "image": "dcanumn/cabinet:stable"
    },
    "custom": {
        "cbrain:readonly-input-files": true,
        "cbrain:author": "Erik Lee <leex6144@umn.edu>",
        "cbrain:no-run-id-for-outputs": [ "prebibsnet_output_dir",
        "bibsnet_output_dir",
        "postbibsnet_output_dir",
        "precomputed_output_dir"],
        "cbrain:integrator_modules": {
            "BoutiquesFileTypeVerifier": {
                "subject_dir": [ "BidsSubject" ]
            },
            "BoutiquesFileNameMatcher": {
                "subject_dir": "^sub-[a-zA-Z0-9_]+$"
            },
            "BoutiquesOutputFileTypeSetter": {
                "output_dir": "CABINETOutput"
            },
            "BoutiquesBidsSingleSubjectMaker": "subject_dir",
            "BoutiquesForcedOutputBrowsePath" : {
              "prebibsnet_output_dir": "prebibsnet",
              "bibsnet_output_dir": "bibsnet",
              "postbibsnet_output_dir": "postbibsnet",
              "precomputed_output_dir": "precomputed"
            }
        }
    }
}
